{"ast":null,"code":"import { call, select } from \"redux-saga/effects\";\nimport axios from 'axios';\nimport { AppSettings } from \"../../utils/appSettings\";\n\nconst getToken = state => {\n  return state.context.accessToken;\n};\n\nexport function* uploadAttachment({\n  file\n}) {\n  const tokenState = yield select(getToken);\n  const token = tokenState || AppSettings.TEST_TOKEN;\n  var formData = new FormData();\n  formData.append('operations', `{\n        \"query\":\"mutation uploadFile($file:Upload!,$fileId:String,$relativePath:String){uploadFile(file:$file,fileId:$fileId,relativePath:$relativePath)}\",\"variables\":{\"file\":null,\"fileId\":\"${file.name}\",\"relativePath\":\"APIEamwrkreq\"}\n        }`);\n  formData.append('map', `{\"file\": [\"variables.file\"]}`);\n  formData.append('file', file);\n  console.log(\"formData\", formData); // const state = window.store.getState();\n\n  try {\n    const response = yield call(axios.post, AppSettings.API_URL, formData, {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    });\n    const {\n      data\n    } = JSON.parse(response.data.data.uploadFile);\n    return {\n      data\n    };\n  } catch (e) {\n    return {\n      error: 'Upload failed'\n    };\n  }\n}","map":{"version":3,"sources":["/Users/plsingh/Downloads/archive-19Sep-Sunday/src/sagas/attachment/index.js"],"names":["call","select","axios","AppSettings","getToken","state","context","accessToken","uploadAttachment","file","tokenState","token","TEST_TOKEN","formData","FormData","append","name","console","log","response","post","API_URL","headers","Authorization","data","JSON","parse","uploadFile","e","error"],"mappings":"AACA,SAASA,IAAT,EAAeC,MAAf,QAA6B,oBAA7B;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,WAAT,QAA4B,yBAA5B;;AAEA,MAAMC,QAAQ,GAAIC,KAAD,IAAW;AAC1B,SAAOA,KAAK,CAACC,OAAN,CAAcC,WAArB;AACD,CAFD;;AAGA,OAAO,UAAUC,gBAAV,CAA2B;AAAEC,EAAAA;AAAF,CAA3B,EAAqC;AAC1C,QAAMC,UAAU,GAAG,MAAMT,MAAM,CAACG,QAAD,CAA/B;AACA,QAAMO,KAAK,GAAGD,UAAU,IAAIP,WAAW,CAACS,UAAxC;AACA,MAAIC,QAAQ,GAAG,IAAIC,QAAJ,EAAf;AACAD,EAAAA,QAAQ,CAACE,MAAT,CAAgB,YAAhB,EAA+B;AACjC,gMAAgMN,IAAI,CAACO,IAAK;AAC1M,UAFE;AAGAH,EAAAA,QAAQ,CAACE,MAAT,CAAgB,KAAhB,EAAwB,8BAAxB;AACAF,EAAAA,QAAQ,CAACE,MAAT,CAAgB,MAAhB,EAAwBN,IAAxB;AACAQ,EAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAwBL,QAAxB,EAT0C,CAU1C;;AACA,MAAI;AACF,UAAMM,QAAQ,GAAG,MAAMnB,IAAI,CAACE,KAAK,CAACkB,IAAP,EAAajB,WAAW,CAACkB,OAAzB,EACzBR,QADyB,EACf;AAAES,MAAAA,OAAO,EAAE;AAAEC,QAAAA,aAAa,EAAG,UAASZ,KAAM;AAAjC;AAAX,KADe,CAA3B;AAEA,UAAM;AAAEa,MAAAA;AAAF,QAAWC,IAAI,CAACC,KAAL,CAAWP,QAAQ,CAACK,IAAT,CAAcA,IAAd,CAAmBG,UAA9B,CAAjB;AACA,WAAO;AAAEH,MAAAA;AAAF,KAAP;AACD,GALD,CAMA,OAAOI,CAAP,EAAU;AACR,WAAO;AAAEC,MAAAA,KAAK,EAAE;AAAT,KAAP;AACD;AACF","sourcesContent":["\nimport { call, select } from \"redux-saga/effects\";\nimport axios from 'axios';\nimport { AppSettings } from \"../../utils/appSettings\";\n\nconst getToken = (state) => {\n  return state.context.accessToken;\n}\nexport function* uploadAttachment({ file }) {\n  const tokenState = yield select(getToken);\n  const token = tokenState || AppSettings.TEST_TOKEN;\n  var formData = new FormData();\n  formData.append('operations', `{\n        \"query\":\"mutation uploadFile($file:Upload!,$fileId:String,$relativePath:String){uploadFile(file:$file,fileId:$fileId,relativePath:$relativePath)}\",\"variables\":{\"file\":null,\"fileId\":\"${file.name}\",\"relativePath\":\"APIEamwrkreq\"}\n        }`);\n  formData.append('map', `{\"file\": [\"variables.file\"]}`);\n  formData.append('file', file);\n  console.log(\"formData\", formData);\n  // const state = window.store.getState();\n  try {\n    const response = yield call(axios.post, AppSettings.API_URL,\n      formData, { headers: { Authorization: `Bearer ${token}`, } })\n    const { data } = JSON.parse(response.data.data.uploadFile);\n    return { data };\n  }\n  catch (e) {\n    return { error: 'Upload failed' }\n  }\n}\n"]},"metadata":{},"sourceType":"module"}