{"ast":null,"code":"var _jsxFileName = \"/Users/plsingh/Downloads/archive-19Sep-Sunday/src/pages/WorkRequest/Detail/View/index.jsx\",\n    _s = $RefreshSig$();\n\nimport { makeStyles } from \"@material-ui/styles\";\nimport { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { useHistory, useRouteMatch } from \"react-router-dom\";\nimport actions from \"../../../../actions\";\nimport AssignedIcon from \"../../../../assets/Icons/AssignedIcon\";\nimport OverviewIcon from \"../../../../assets/Icons/OverviewIcon\";\nimport TimelineIcon from \"../../../../assets/Icons/TimelineIcon\";\nimport EAMButton from \"../../../../components/EAMButton\";\nimport { useConfirmationDialog } from \"../../../../components/EAMConfirmDialog\";\nimport EAMMenu from \"../../../../components/EAMMenu\";\nimport EAMTabs from \"../../../../components/EAMTabs\";\nimport FormWrapper from \"../../../../components/Form/FormWrapper\";\nimport PageHeader from \"../../../../components/PageHeader\";\nimport Spinner from \"../../../../components/Spinner\";\nimport { selectors } from \"../../../../reducers\";\nimport { ACTION_LIST_MAP } from \"../../List/util\";\nimport AssignedWO from \"./AssignedWO\";\nimport WROverview from \"./Overview\";\nimport SuggestedWO from \"./SuggestedWO\";\nimport WrTimeline from \"./Timeline\";\nimport WRNav from \"./WRNav\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst useStyles = makeStyles({\n  container: {\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%',\n    paddingLeft: 10,\n    paddingRight: 10\n  },\n  wrapper: {\n    height: 'calc(100% - 71px)',\n    flex: '1',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  tabsWrapper: {\n    boxShadow: '0px 2px 4px rgba(0, 0, 0, 0.1)'\n  },\n  spinner: {\n    margin: 'auto'\n  },\n  actionWrapper: {\n    display: 'flex',\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    background: '#FFFFFF',\n    boxShadow: '0px -4px 4px rgba(0, 0, 0, 0.05)',\n    zIndex: 999,\n    minHeight: 50\n  },\n  menu: {\n    display: 'flex',\n    '& > button': {\n      marginTop: 'auto',\n      marginBottom: 'auto'\n    }\n  }\n});\nconst emptySet = [];\nconst Ext = window.Ext;\nexport default function ViewWorkRequestDetail(props) {\n  _s();\n\n  var _workRequestDetail$va;\n\n  const classes = useStyles();\n  const dispatch = useDispatch();\n  const history = useHistory();\n  const match = useRouteMatch();\n  const {\n    wrNo\n  } = match.params;\n  const [activeTabIndex, setActiveTabIndex] = useState(1);\n  const refToTop = useRef();\n  const {\n    getConfirmation\n  } = useConfirmationDialog();\n  const workRequestDetail = useSelector(state => selectors.workOrderResource(state, wrNo));\n  const workRequestActionErrorMsg = useSelector(state => selectors.workRequestActionErrorMsg(state, wrNo));\n  const availActions = useSelector(state => selectors.workRequestAvailActions(state, wrNo));\n  const [firstAction, secondAction, ...otherActions] = availActions || emptySet;\n  console.log(\"availActions\", availActions);\n  const hasWOAssigned = workRequestDetail === null || workRequestDetail === void 0 ? void 0 : (_workRequestDetail$va = workRequestDetail.value) === null || _workRequestDetail$va === void 0 ? void 0 : _workRequestDetail$va.SuggestedOrAssignedWOFlag;\n  useEffect(() => {\n    var _refToTop$current;\n\n    refToTop === null || refToTop === void 0 ? void 0 : (_refToTop$current = refToTop.current) === null || _refToTop$current === void 0 ? void 0 : _refToTop$current.scrollIntoView();\n  }, [activeTabIndex]);\n  useEffect(() => {\n    dispatch(actions.workRequestV2.resource.request(wrNo));\n    dispatch(actions.workRequestV2.resource.requestActions(wrNo));\n  }, [dispatch, wrNo]);\n  const tabsData = useMemo(() => {\n    const arr = [{\n      label: 'WR Overview',\n      icon: /*#__PURE__*/_jsxDEV(OverviewIcon, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 37\n      }, this)\n    }, {\n      label: 'Timeline',\n      icon: /*#__PURE__*/_jsxDEV(TimelineIcon, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 34\n      }, this)\n    }];\n\n    if (hasWOAssigned) {\n      arr.unshift({\n        label: 'Assigned WO',\n        icon: /*#__PURE__*/_jsxDEV(AssignedIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 49\n        }, this)\n      });\n    } else {\n      arr.unshift({\n        label: 'Suggested WO',\n        icon: /*#__PURE__*/_jsxDEV(AssignedIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 50\n        }, this)\n      });\n    }\n\n    return arr;\n  }, [hasWOAssigned]);\n\n  const renderData = () => {\n    if (activeTabIndex === 0) {\n      if (hasWOAssigned) {\n        return /*#__PURE__*/_jsxDEV(FormWrapper, {\n          children: /*#__PURE__*/_jsxDEV(AssignedWO, {\n            wrNo: wrNo\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 115,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 11\n        }, this);\n      } else {\n        return /*#__PURE__*/_jsxDEV(SuggestedWO, {\n          wrNo: wrNo\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 11\n        }, this);\n      }\n    } else if (activeTabIndex === 1) {\n      return /*#__PURE__*/_jsxDEV(FormWrapper, {\n        wrapperRef: refToTop,\n        children: /*#__PURE__*/_jsxDEV(WROverview, {\n          value: workRequestDetail.value\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 9\n      }, this);\n    } else if (activeTabIndex === 2) {\n      return /*#__PURE__*/_jsxDEV(WrTimeline, {\n        wrNo: wrNo\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 15\n      }, this);\n    }\n  };\n\n  useEffect(() => {\n    if (workRequestActionErrorMsg) {\n      Ext.Msg.alert(\"Error\", workRequestActionErrorMsg);\n      Ext.Msg.setHideAnimation(null);\n    }\n  }, [workRequestActionErrorMsg]);\n  useEffect(() => {\n    return () => {\n      dispatch(actions.workRequestV2.resource.clearMessage(wrNo));\n    };\n  }, [dispatch, wrNo]);\n  const handleMenuItemClick = useCallback(async id => {\n    if ([\"AUT\", \"REJ\", \"AUTCRWO\", \"FRWD\", \"CNL\", \"MVPL\", \"CLS\", \"REV\"].indexOf(id) !== -1) {\n      const confirmed = await getConfirmation({\n        title: ACTION_LIST_MAP[id].title,\n        message: ACTION_LIST_MAP[id].message\n      });\n\n      if (confirmed) {\n        dispatch(actions.workRequestV2.resource.triggerAction({\n          actionFlag: id,\n          wrNo\n        }));\n      }\n    } else if (id === 'EDT') {\n      history.push(`/workRequest/manage/${wrNo}`);\n    } else if (id === 'CPY') {\n      history.push(`/workRequest/manage/copy/${wrNo}`);\n    }\n  }, [dispatch, getConfirmation, history, wrNo]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: classes.container,\n    children: [/*#__PURE__*/_jsxDEV(PageHeader, {\n      title: \"Work Request\",\n      showBack: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(WRNav, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 7\n    }, this), ['received', 'error'].includes(workRequestDetail.status) ? /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: classes.tabsWrapper,\n        children: /*#__PURE__*/_jsxDEV(EAMTabs, {\n          tabsData: tabsData,\n          value: activeTabIndex,\n          onChange: (event, ind) => {\n            setActiveTabIndex(ind);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 13\n      }, this), renderData(), activeTabIndex !== 2 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: classes.actionWrapper,\n        children: [(otherActions === null || otherActions === void 0 ? void 0 : otherActions.length) ? /*#__PURE__*/_jsxDEV(EAMMenu, {\n          id: \"wRActions\",\n          className: classes.menu,\n          onMenuItemClick: handleMenuItemClick,\n          label: /*#__PURE__*/_jsxDEV(EAMButton, {\n            className: classes.moreBtn,\n            variant: \"secondary\",\n            children: \"More Actions\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 188,\n            columnNumber: 28\n          }, this),\n          value: otherActions\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 19\n        }, this) : null, secondAction ? /*#__PURE__*/_jsxDEV(EAMButton, {\n          onClick: () => {\n            handleMenuItemClick(secondAction.id);\n          },\n          variant: \"secondary\",\n          children: (secondAction === null || secondAction === void 0 ? void 0 : secondAction.label) || ''\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 19\n        }, this) : null, secondAction ? /*#__PURE__*/_jsxDEV(EAMButton, {\n          onClick: () => {\n            handleMenuItemClick(firstAction.id);\n          },\n          children: (firstAction === null || firstAction === void 0 ? void 0 : firstAction.label) || ''\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 19\n        }, this) : null]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 15\n      }, this) : null]\n    }, void 0, true) : /*#__PURE__*/_jsxDEV(Spinner, {\n      speed: 0.5,\n      className: classes.spinner,\n      type: \"moon\",\n      size: 100\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 166,\n    columnNumber: 5\n  }, this);\n}\n\n_s(ViewWorkRequestDetail, \"okNhh7KRHgpxidk48BIswzXuOGg=\", false, function () {\n  return [useStyles, useDispatch, useHistory, useRouteMatch, useConfirmationDialog, useSelector, useSelector, useSelector];\n});\n\n_c = ViewWorkRequestDetail;\n\nvar _c;\n\n$RefreshReg$(_c, \"ViewWorkRequestDetail\");","map":{"version":3,"sources":["/Users/plsingh/Downloads/archive-19Sep-Sunday/src/pages/WorkRequest/Detail/View/index.jsx"],"names":["makeStyles","useCallback","useEffect","useMemo","useRef","useState","useDispatch","useSelector","useHistory","useRouteMatch","actions","AssignedIcon","OverviewIcon","TimelineIcon","EAMButton","useConfirmationDialog","EAMMenu","EAMTabs","FormWrapper","PageHeader","Spinner","selectors","ACTION_LIST_MAP","AssignedWO","WROverview","SuggestedWO","WrTimeline","WRNav","useStyles","container","height","display","flexDirection","root","paddingLeft","paddingRight","wrapper","flex","tabsWrapper","boxShadow","spinner","margin","actionWrapper","justifyContent","background","zIndex","minHeight","menu","marginTop","marginBottom","emptySet","Ext","window","ViewWorkRequestDetail","props","classes","dispatch","history","match","wrNo","params","activeTabIndex","setActiveTabIndex","refToTop","getConfirmation","workRequestDetail","state","workOrderResource","workRequestActionErrorMsg","availActions","workRequestAvailActions","firstAction","secondAction","otherActions","console","log","hasWOAssigned","value","SuggestedOrAssignedWOFlag","current","scrollIntoView","workRequestV2","resource","request","requestActions","tabsData","arr","label","icon","unshift","renderData","Msg","alert","setHideAnimation","clearMessage","handleMenuItemClick","id","indexOf","confirmed","title","message","triggerAction","actionFlag","push","includes","status","event","ind","length","moreBtn"],"mappings":"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","sourcesContent":["import { makeStyles } from \"@material-ui/styles\";\nimport { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\"\nimport { useHistory, useRouteMatch } from \"react-router-dom\";\nimport actions from \"../../../../actions\";\nimport AssignedIcon from \"../../../../assets/Icons/AssignedIcon\";\nimport OverviewIcon from \"../../../../assets/Icons/OverviewIcon\";\nimport TimelineIcon from \"../../../../assets/Icons/TimelineIcon\";\nimport EAMButton from \"../../../../components/EAMButton\";\nimport { useConfirmationDialog } from \"../../../../components/EAMConfirmDialog\";\nimport EAMMenu from \"../../../../components/EAMMenu\";\nimport EAMTabs from \"../../../../components/EAMTabs\";\nimport FormWrapper from \"../../../../components/Form/FormWrapper\";\nimport PageHeader from \"../../../../components/PageHeader\";\nimport Spinner from \"../../../../components/Spinner\";\nimport { selectors } from \"../../../../reducers\";\nimport { ACTION_LIST_MAP } from \"../../List/util\";\nimport AssignedWO from \"./AssignedWO\";\nimport WROverview from \"./Overview\";\nimport SuggestedWO from \"./SuggestedWO\";\nimport WrTimeline from \"./Timeline\";\nimport WRNav from \"./WRNav\";\n\nconst useStyles = makeStyles({\n  container: {\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column',\n  },\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%',\n    paddingLeft: 10,\n    paddingRight: 10,\n  },\n  wrapper: {\n    height: 'calc(100% - 71px)',\n    flex: '1',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  tabsWrapper: {\n    boxShadow: '0px 2px 4px rgba(0, 0, 0, 0.1)'\n  },\n  spinner: {\n    margin: 'auto',\n  },\n  actionWrapper: {\n    display: 'flex',\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    background: '#FFFFFF',\n    boxShadow: '0px -4px 4px rgba(0, 0, 0, 0.05)',\n    zIndex: 999,\n    minHeight: 50,\n  },\n  menu: {\n    display: 'flex',\n    '& > button': {\n      marginTop: 'auto',\n      marginBottom: 'auto'\n    }\n  }\n})\n\nconst emptySet = [];\nconst Ext = window.Ext;\n\nexport default function ViewWorkRequestDetail(props) {\n  const classes = useStyles();\n  const dispatch = useDispatch();\n  const history = useHistory();\n  const match = useRouteMatch();\n  const { wrNo } = match.params;\n  const [activeTabIndex, setActiveTabIndex] = useState(1);\n  const refToTop = useRef();\n  const { getConfirmation } = useConfirmationDialog();\n\n  const workRequestDetail = useSelector(state => selectors.workOrderResource(state, wrNo))\n  const workRequestActionErrorMsg = useSelector(state => selectors.workRequestActionErrorMsg(state, wrNo))\n  \n  const availActions = useSelector(state => selectors.workRequestAvailActions(state, wrNo))\n  const [firstAction, secondAction, ...otherActions] = availActions || emptySet;\n  console.log(\"availActions\", availActions)\n  const hasWOAssigned = workRequestDetail?.value?.SuggestedOrAssignedWOFlag;\n  useEffect(() => {\n    refToTop?.current?.scrollIntoView();\n  }, [activeTabIndex])\n\n  useEffect(() => {\n    dispatch(actions.workRequestV2.resource.request(wrNo))\n    dispatch(actions.workRequestV2.resource.requestActions(wrNo))\n  }, [dispatch, wrNo])\n\n  const tabsData = useMemo(() => {\n    const arr = [\n      { label: 'WR Overview', icon: <OverviewIcon /> },\n      { label: 'Timeline', icon: <TimelineIcon /> }\n    ];\n    if (hasWOAssigned) {\n      arr.unshift({ label: 'Assigned WO', icon: <AssignedIcon /> },)\n    }\n    else {\n      arr.unshift({ label: 'Suggested WO', icon: <AssignedIcon /> },)\n    }\n    return arr;\n  }, [hasWOAssigned]);\n\n  const renderData = () => {\n    if (activeTabIndex === 0) {\n      if (hasWOAssigned) {\n        return (\n          <FormWrapper>\n            <AssignedWO wrNo={wrNo} />\n          </FormWrapper>\n        )\n      }\n      else {\n        return (\n          <SuggestedWO wrNo={wrNo} />\n        )\n      }\n    } else if (activeTabIndex === 1) {\n      return (\n        <FormWrapper wrapperRef={refToTop}>\n          <WROverview value={workRequestDetail.value} />\n        </FormWrapper>\n      )\n    } else if (activeTabIndex === 2) {\n      return (<WrTimeline wrNo={wrNo} />)\n    }\n  }\n  useEffect(() => {\n    if (workRequestActionErrorMsg) {\n      Ext.Msg.alert(\"Error\", workRequestActionErrorMsg);\n      Ext.Msg.setHideAnimation(null);\n    }\n  }, [workRequestActionErrorMsg])\n\n  useEffect(() => {\n    return (() => {\n      dispatch(actions.workRequestV2.resource.clearMessage(wrNo));\n    })\n  },[dispatch, wrNo])\n\n  const handleMenuItemClick = useCallback(async (id) => {\n    if ([\"AUT\", \"REJ\", \"AUTCRWO\", \"FRWD\", \"CNL\", \"MVPL\", \"CLS\", \"REV\"].indexOf(id) !== -1) {\n      const confirmed = await getConfirmation({\n        title: ACTION_LIST_MAP[id].title,\n        message: ACTION_LIST_MAP[id].message,\n      });\n      if (confirmed) {\n        dispatch(actions.workRequestV2.resource.triggerAction({\n          actionFlag: id,\n          wrNo\n        }))\n      }\n    } else if (id === 'EDT') {\n      history.push(`/workRequest/manage/${wrNo}`)\n    } else if (id === 'CPY') {\n      history.push(`/workRequest/manage/copy/${wrNo}`)\n    }\n  }, [dispatch, getConfirmation, history, wrNo])\n  return (\n    <div className={classes.container}>\n      <PageHeader\n        title='Work Request'\n        showBack\n      />\n      <WRNav />\n      {['received', 'error'].includes(workRequestDetail.status) ?\n        (\n          <>\n            <div className={classes.tabsWrapper}>\n              <EAMTabs tabsData={tabsData} value={activeTabIndex} onChange={(event, ind) => {\n                setActiveTabIndex(ind);\n              }} />\n            </div>\n            {renderData()}\n            {activeTabIndex !== 2 ? (\n              <div className={classes.actionWrapper}>\n                {otherActions?.length ? (\n                  <EAMMenu\n                    id=\"wRActions\"\n                    className={classes.menu}\n                    onMenuItemClick={handleMenuItemClick}\n                    label={<EAMButton className={classes.moreBtn} variant=\"secondary\">More Actions</EAMButton>}\n                    value={otherActions}\n                  />\n                ) : null}\n\n                {secondAction ? (\n                  <EAMButton onClick={() => { handleMenuItemClick(secondAction.id) }} variant=\"secondary\">{secondAction?.label || ''}</EAMButton>\n                ) : null}\n                {secondAction ? (\n                  <EAMButton onClick={() => { handleMenuItemClick(firstAction.id) }}>{firstAction?.label || ''}</EAMButton>\n                ) : null}\n              </div>\n            ) : null}\n          </>\n        ) : <Spinner speed={0.5} className={classes.spinner} type=\"moon\" size={100} />\n      }\n\n    </div >\n  )\n}\n"]},"metadata":{},"sourceType":"module"}