{"ast":null,"code":"var _jsxFileName = \"/Users/plsingh/Downloads/archive-19Sep-Sunday/src/pages/WorkRequest/List/index.jsx\",\n    _s = $RefreshSig$();\n\nimport { makeStyles } from \"@material-ui/styles\";\nimport { useCallback, useEffect, useMemo, useState } from \"react\";\nimport { shallowEqual, useDispatch, useSelector } from \"react-redux\";\nimport { useRouteMatch } from \"react-router-dom/cjs/react-router-dom.min\";\nimport actions from \"../../../actions\";\nimport PageHeader from \"../../../components/PageHeader\";\nimport { selectors } from \"../../../reducers\";\nimport Spinner from \"../../../components/Spinner\";\nimport WorkRequestListing from \"./View\";\nimport { Typography } from \"@material-ui/core\";\nimport EAMTabs from \"../../../components/EAMTabs\";\nimport { ACTION_LIST_MAP } from \"./util\";\nimport EAMButton from \"../../../components/EAMButton\";\nimport { useConfirmationDialog } from \"../../../components/EAMConfirmDialog\";\nimport EAMMenu from \"../../../components/EAMMenu\";\nimport WorkRequestListFilter from \"./Filter\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst useStyles = makeStyles({\n  container: {\n    height: '100%'\n  },\n  wrapper: {\n    height: 'calc(100% - 61px)',\n    flex: '1',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  listWrapper: {\n    flex: 1,\n    display: 'flex',\n    flexDirection: 'column',\n    overflow: 'auto'\n  },\n  spinner: {\n    margin: 'auto'\n  },\n  count: {\n    fontWeight: '800',\n    fontSize: 16,\n    color: '#33415C',\n    textAlign: 'center'\n  },\n  status: {\n    color: 'white',\n    fontWeight: 'bold',\n    fontSize: 13\n  },\n  actionWrapper: {\n    display: 'flex',\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    background: '#FFFFFF',\n    boxShadow: '0px -4px 4px rgba(0, 0, 0, 0.05)',\n    zIndex: 999\n  },\n  moreBtn: {\n    borderRight: '1px solid #e9ebef'\n  }\n});\nconst emptySet = [];\nexport default function WorkRequestList(props) {\n  _s();\n\n  const match = useRouteMatch();\n  const classes = useStyles();\n  const dispatch = useDispatch();\n  const {\n    getConfirmation\n  } = useConfirmationDialog();\n  const {\n    groupBy,\n    status: subGroup\n  } = match.params;\n  const hideTopFilterPanel = groupBy === 'Status' && subGroup !== undefined;\n  const [showFilterScreen, setShowFilterScreen] = useState(false);\n  const isAnyWRItemSelected = useSelector(state => selectors.isAnyWRItemSelected(state, groupBy));\n  const statusName = useSelector(state => {\n    selectors.workRequestStatusName(state, groupBy, subGroup);\n  });\n  console.log(\"statusName\", statusName);\n  const workRequestCountArr = useSelector(state => {\n    const {\n      count\n    } = selectors.workRequestListObj(state, groupBy);\n\n    if (!Array.isArray(count === null || count === void 0 ? void 0 : count.workrequestcount)) {\n      return undefined;\n    }\n\n    return count.workrequestcount.map(i => ({\n      label: i.tabdata,\n      value: i.tabvalue,\n      id: i.hdn_card_code,\n      circlecolor: i.circlecolor,\n      icon: /*#__PURE__*/_jsxDEV(Typography, {\n        className: classes.count,\n        children: i.tabvalue\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 139\n      }, this)\n    }));\n  }, shallowEqual);\n  const activeTabIndex = useSelector(state => {\n    const {\n      count,\n      taskStatus\n    } = selectors.workRequestListObj(state, groupBy);\n    console.log(\"taskStatus\", taskStatus);\n\n    if (!Array.isArray(count === null || count === void 0 ? void 0 : count.workrequestcount)) {\n      return undefined;\n    }\n\n    if (!taskStatus) {\n      return 0;\n    }\n\n    return count.workrequestcount.findIndex(i => i.hdn_card_code === taskStatus);\n  }, shallowEqual); // const defaultSelectedTab = isManager && workRequestSet.length ? workRequestSet[0].id : undefined;\n\n  const {\n    status,\n    taskStatus\n  } = useSelector(state => {\n    const {\n      status,\n      taskStatus\n    } = selectors.workRequestListObj(state, groupBy);\n    return {\n      status,\n      taskStatus\n    };\n  }, shallowEqual);\n  const listActions = useSelector(state => {\n    return selectors.workRequestListActions(state, taskStatus);\n  }, shallowEqual);\n  const [firstAction, secondAction, ...otherActions] = listActions || emptySet;\n  const rightActions = useMemo(() => {\n    if (!subGroup) {\n      return [{\n        id: \"1\",\n        type: \"icon\",\n        iconCls: \"filter_list-nbicon\",\n        action: () => {\n          setShowFilterScreen(true);\n        }\n      }];\n    }\n\n    return [{\n      type: 'status',\n      action: () => {},\n      cls: classes.status,\n      text: statusName\n    }];\n  }, [classes.status, subGroup, statusName]);\n  const handleTabChange = useCallback((event, index) => {\n    if (index !== activeTabIndex) dispatch(actions.workRequestV2.list.updateTaskStatus(groupBy, workRequestCountArr[index].id));\n  }, [activeTabIndex, dispatch, groupBy, workRequestCountArr]);\n  useEffect(() => {\n    dispatch(actions.workRequestV2.list.request(groupBy, subGroup));\n  }, [dispatch, groupBy, subGroup]);\n  useEffect(() => {\n    if (taskStatus) {\n      dispatch(actions.workRequestV2.list.requestActions(taskStatus));\n    }\n  }, [dispatch, taskStatus]); // useEffect(() => {\n  //   if (isManager) {\n  //     if (defaultSelectedTab) {\n  //       dispatch(actions.workRequestV2.list.init(groupBy, defaultSelectedTab))\n  //     }\n  //     return;\n  //   }\n  //   dispatch(actions.workRequestV2.list.init(groupBy, matchStatus))\n  // }, [defaultSelectedTab, dispatch, groupBy, isManager, matchStatus])\n\n  const handleMenuItemClick = useCallback(async id => {\n    if ([\"AUT\", \"REJ\", \"AUTCRWO\", \"FRWD\", \"CNL\", \"MVPL\", \"CLS\", \"REV\"].indexOf(id) !== -1) {\n      const confirmed = await getConfirmation({\n        title: ACTION_LIST_MAP[id].title,\n        message: ACTION_LIST_MAP[id].message\n      });\n\n      if (confirmed) {\n        dispatch(actions.workRequestV2.list.triggerAction({\n          groupBy: groupBy,\n          actionFlag: id,\n          allSelected: true\n        }));\n      }\n    }\n  }, [dispatch, groupBy, getConfirmation]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: classes.container,\n    children: [/*#__PURE__*/_jsxDEV(PageHeader, {\n      title: \"Work Request\",\n      showBack: true,\n      rightActions: rightActions // statusName\n\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: classes.wrapper,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: classes.tabContainer\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 9\n      }, this), hideTopFilterPanel ? null : /*#__PURE__*/_jsxDEV(EAMTabs, {\n        tabsData: workRequestCountArr,\n        value: activeTabIndex,\n        onChange: handleTabChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 38\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: classes.listWrapper,\n        children: status === 'requested' ? /*#__PURE__*/_jsxDEV(Spinner, {\n          speed: 0.5,\n          className: classes.spinner,\n          type: \"moon\",\n          size: 100\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 16\n        }, this) : /*#__PURE__*/_jsxDEV(WorkRequestListing, {\n          canManage: !hideTopFilterPanel\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 9\n      }, this), !hideTopFilterPanel && isAnyWRItemSelected ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: classes.actionWrapper,\n        children: [(otherActions === null || otherActions === void 0 ? void 0 : otherActions.length) ? /*#__PURE__*/_jsxDEV(EAMMenu, {\n          id: \"wRActions\",\n          onMenuItemClick: handleMenuItemClick,\n          label: /*#__PURE__*/_jsxDEV(EAMButton, {\n            className: classes.moreBtn,\n            variant: \"secondary\",\n            children: \"More Actions\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 193,\n            columnNumber: 24\n          }, this),\n          value: otherActions\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 190,\n          columnNumber: 15\n        }, this) : null, secondAction ? /*#__PURE__*/_jsxDEV(EAMButton, {\n          onClick: () => {\n            handleMenuItemClick(secondAction.id);\n          },\n          variant: \"secondary\",\n          children: (secondAction === null || secondAction === void 0 ? void 0 : secondAction.label) || ''\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 199,\n          columnNumber: 15\n        }, this) : null, secondAction ? /*#__PURE__*/_jsxDEV(EAMButton, {\n          onClick: () => {\n            handleMenuItemClick(firstAction.id);\n          },\n          children: (firstAction === null || firstAction === void 0 ? void 0 : firstAction.label) || ''\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 15\n        }, this) : null]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 11\n      }, this) : null, showFilterScreen ? /*#__PURE__*/_jsxDEV(WorkRequestListFilter, {\n        onClose: () => {\n          setShowFilterScreen(false);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 11\n      }, this) : null]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 166,\n    columnNumber: 5\n  }, this);\n}\n\n_s(WorkRequestList, \"0FzdIqfw6Tkg18xGDTc9aQZaKiM=\", false, function () {\n  return [useRouteMatch, useStyles, useDispatch, useConfirmationDialog, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector];\n});\n\n_c = WorkRequestList;\n\nvar _c;\n\n$RefreshReg$(_c, \"WorkRequestList\");","map":{"version":3,"sources":["/Users/plsingh/Downloads/archive-19Sep-Sunday/src/pages/WorkRequest/List/index.jsx"],"names":["makeStyles","useCallback","useEffect","useMemo","useState","shallowEqual","useDispatch","useSelector","useRouteMatch","actions","PageHeader","selectors","Spinner","WorkRequestListing","Typography","EAMTabs","ACTION_LIST_MAP","EAMButton","useConfirmationDialog","EAMMenu","WorkRequestListFilter","useStyles","container","height","wrapper","flex","display","flexDirection","listWrapper","overflow","spinner","margin","count","fontWeight","fontSize","color","textAlign","status","actionWrapper","justifyContent","background","boxShadow","zIndex","moreBtn","borderRight","emptySet","WorkRequestList","props","match","classes","dispatch","getConfirmation","groupBy","subGroup","params","hideTopFilterPanel","undefined","showFilterScreen","setShowFilterScreen","isAnyWRItemSelected","state","statusName","workRequestStatusName","console","log","workRequestCountArr","workRequestListObj","Array","isArray","workrequestcount","map","i","label","tabdata","value","tabvalue","id","hdn_card_code","circlecolor","icon","activeTabIndex","taskStatus","findIndex","listActions","workRequestListActions","firstAction","secondAction","otherActions","rightActions","type","iconCls","action","cls","text","handleTabChange","event","index","workRequestV2","list","updateTaskStatus","request","requestActions","handleMenuItemClick","indexOf","confirmed","title","message","triggerAction","actionFlag","allSelected","tabContainer","length"],"mappings":"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","sourcesContent":["import { makeStyles } from \"@material-ui/styles\";\nimport { useCallback, useEffect, useMemo, useState } from \"react\";\nimport { shallowEqual, useDispatch, useSelector } from \"react-redux\";\nimport { useRouteMatch } from \"react-router-dom/cjs/react-router-dom.min\";\nimport actions from \"../../../actions\";\nimport PageHeader from \"../../../components/PageHeader\";\nimport { selectors } from \"../../../reducers\";\nimport Spinner from \"../../../components/Spinner\";\nimport WorkRequestListing from \"./View\";\nimport { Typography } from \"@material-ui/core\";\nimport EAMTabs from \"../../../components/EAMTabs\";\nimport { ACTION_LIST_MAP } from \"./util\";\nimport EAMButton from \"../../../components/EAMButton\";\nimport { useConfirmationDialog } from \"../../../components/EAMConfirmDialog\";\nimport EAMMenu from \"../../../components/EAMMenu\";\nimport WorkRequestListFilter from \"./Filter\";\n\nconst useStyles = makeStyles({\n  container: {\n    height: '100%'\n  },\n  wrapper: {\n    height: 'calc(100% - 61px)',\n    flex: '1',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  listWrapper: {\n    flex: 1,\n    display: 'flex',\n    flexDirection: 'column',\n    overflow: 'auto'\n  },\n  spinner: {\n    margin: 'auto',\n  },\n  count: {\n    fontWeight: '800',\n    fontSize: 16,\n    color: '#33415C',\n    textAlign: 'center'\n  },\n  status: {\n    color: 'white',\n    fontWeight: 'bold',\n    fontSize: 13,\n  },\n  actionWrapper: {\n    display: 'flex',\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    background: '#FFFFFF',\n    boxShadow: '0px -4px 4px rgba(0, 0, 0, 0.05)',\n    zIndex: 999,\n  },\n  moreBtn: {\n    borderRight: '1px solid #e9ebef'\n  }\n})\nconst emptySet = [];\nexport default function WorkRequestList(props) {\n  const match = useRouteMatch();\n  const classes = useStyles();\n  const dispatch = useDispatch();\n  const { getConfirmation } = useConfirmationDialog();\n  const { groupBy, status: subGroup } = match.params;\n  const hideTopFilterPanel = groupBy === 'Status' && subGroup !== undefined;\n  const [showFilterScreen, setShowFilterScreen] = useState(false);\n  const isAnyWRItemSelected = useSelector(state => selectors.isAnyWRItemSelected(state, groupBy));\n  const statusName = useSelector(state => {\n    selectors.workRequestStatusName(state, groupBy, subGroup)\n  });\n\n  console.log(\"statusName\", statusName)\n  const workRequestCountArr = useSelector(state => {\n    const { count } = selectors.workRequestListObj(state, groupBy);\n    if (!Array.isArray(count?.workrequestcount)) {\n      return undefined;\n    }\n    return count.workrequestcount.map(i => ({ label: i.tabdata, value: i.tabvalue, id: i.hdn_card_code, circlecolor: i.circlecolor, icon: <Typography className={classes.count}>{i.tabvalue}</Typography> }))\n  }, shallowEqual);\n\n  const activeTabIndex = useSelector(state => {\n    const { count, taskStatus } = selectors.workRequestListObj(state, groupBy);\n    console.log(\"taskStatus\", taskStatus)\n    if (!Array.isArray(count?.workrequestcount)) {\n      return undefined;\n    }\n    if (!taskStatus) {\n      return 0;\n    }\n    return count.workrequestcount.findIndex(i => i.hdn_card_code === taskStatus);\n  }, shallowEqual);\n\n  // const defaultSelectedTab = isManager && workRequestSet.length ? workRequestSet[0].id : undefined;\n  const { status, taskStatus } = useSelector(state => {\n    const { status, taskStatus } = selectors.workRequestListObj(state, groupBy);\n    return { status, taskStatus }\n  }, shallowEqual);\n\n  const listActions = useSelector(state => {\n    return selectors.workRequestListActions(state, taskStatus);\n  }, shallowEqual)\n\n  const [firstAction, secondAction, ...otherActions] = listActions || emptySet;\n\n  const rightActions = useMemo(() => {\n    if (!subGroup) {\n      return [{\n        id: \"1\",\n        type: \"icon\",\n        iconCls: \"filter_list-nbicon\",\n        action: () => { setShowFilterScreen(true) },\n      }]\n    }\n    return [{\n      type: 'status',\n      action: () => { },\n      cls: classes.status,\n      text: statusName,\n    }]\n  }, [classes.status, subGroup, statusName])\n  const handleTabChange = useCallback((event, index) => {\n    if (index !== activeTabIndex)\n      dispatch(actions.workRequestV2.list.updateTaskStatus(groupBy, workRequestCountArr[index].id))\n  }, [activeTabIndex, dispatch, groupBy, workRequestCountArr])\n\n\n  useEffect(() => {\n    dispatch(actions.workRequestV2.list.request(groupBy, subGroup))\n  }, [dispatch, groupBy, subGroup])\n  useEffect(() => {\n    if (taskStatus) {\n      dispatch(actions.workRequestV2.list.requestActions(taskStatus))\n    }\n  }, [dispatch, taskStatus])\n\n\n  // useEffect(() => {\n  //   if (isManager) {\n  //     if (defaultSelectedTab) {\n  //       dispatch(actions.workRequestV2.list.init(groupBy, defaultSelectedTab))\n  //     }\n  //     return;\n  //   }\n  //   dispatch(actions.workRequestV2.list.init(groupBy, matchStatus))\n  // }, [defaultSelectedTab, dispatch, groupBy, isManager, matchStatus])\n\n  const handleMenuItemClick = useCallback(async (id) => {\n    if ([\"AUT\", \"REJ\", \"AUTCRWO\", \"FRWD\", \"CNL\", \"MVPL\", \"CLS\", \"REV\"].indexOf(id) !== -1) {\n      const confirmed = await getConfirmation({\n        title: ACTION_LIST_MAP[id].title,\n        message: ACTION_LIST_MAP[id].message,\n      });\n      if (confirmed) {\n        dispatch(actions.workRequestV2.list.triggerAction({\n          groupBy: groupBy,\n          actionFlag: id,\n          allSelected: true,\n        }))\n      }\n    }\n  }, [dispatch, groupBy, getConfirmation])\n\n  return (\n    <div className={classes.container}>\n      <PageHeader\n        title='Work Request'\n        showBack\n        rightActions={rightActions}\n      // statusName\n      />\n      <div className={classes.wrapper}>\n        <div className={classes.tabContainer}>\n        </div>\n        {hideTopFilterPanel ? null : <EAMTabs tabsData={workRequestCountArr} value={activeTabIndex} onChange={handleTabChange} />}\n        <div className={classes.listWrapper}>\n          {status === 'requested' ?\n            (\n              (<Spinner speed={0.5} className={classes.spinner} type=\"moon\" size={100} />)\n            ) :\n            <WorkRequestListing\n              canManage={!hideTopFilterPanel}\n            />\n          }\n        </div>\n        {!hideTopFilterPanel && isAnyWRItemSelected ? (\n          <div className={classes.actionWrapper}>\n            {otherActions?.length ? (\n              <EAMMenu\n                id=\"wRActions\"\n                onMenuItemClick={handleMenuItemClick}\n                label={<EAMButton className={classes.moreBtn} variant=\"secondary\">More Actions</EAMButton>}\n                value={otherActions}\n              />\n            ) : null}\n\n            {secondAction ? (\n              <EAMButton onClick={() => { handleMenuItemClick(secondAction.id) }} variant=\"secondary\">{secondAction?.label || ''}</EAMButton>\n            ) : null}\n            {secondAction ? (\n              <EAMButton onClick={() => { handleMenuItemClick(firstAction.id) }}>{firstAction?.label || ''}</EAMButton>\n            ) : null}\n\n          </div>\n        ) : null}\n        {showFilterScreen ? (\n          <WorkRequestListFilter\n            onClose={() => { setShowFilterScreen(false) }}\n          />\n        ) : null}\n      </div>\n\n    </div>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}